
<div class="col-sm-5">
<form class="form-horizontal" id="task_runner" target="_self" method="post" action="/v1/<%=@project_name%>/interactive/single">
  <div class="form-group">
    <!-- <select name="task" id="task_name"> -->
    <label for="task_name" class="col-xs-4 control-label">Task</label>
    <div class="col-xs-6">
    <select class="form-control input-sm" name="task" id="task_name">

      <!-- iterate through the tasks an create each one, checking to see if it matches our entity -->
      <% @task_classes.sort_by { |obj| obj.to_s }.each do |task_class|

            # Skip to the next task unless the current type is allowed
            next unless ( @entity.allowed_tasks.include?(task_class) ||
                          task_class.metadata[:allowed_types].include?("*") ) if @entity
        %>

        <!-- set up the task in an option box, default to search_bing -->
        <option value="<%= task_class.metadata[:name] %>"
          <% if @task_result %>
            <%= "selected='selected'" if @task_result.task_name == task_class.metadata[:name] %>
          <% else %>
            <%= "selected='selected'" if task_class.metadata[:name] == "" %>
          <% end %>
          ><%= task_class.metadata[:pretty_name] %>
        </option>

    <% end %>
    </select>
    </div>
  </div>

  <!-- Get all attributes and use this to create an entity -->
  <% if @entity %>
      <%= @entity.form  %>
      <input type="hidden" name="entity_id" value="<%=@entity.id%>">
  <% else %>
    <div class="form-group">
      <label for="entity_type" class="col-xs-4 control-label">Entity Type</label>
      <div class="col-xs-6">
        <select class="form-control input-sm" id="entity_type" name="entity_type">
        </select>
      </div>
    </div>
    <div class="form-group">
      <label for="attrib_name" class="col-xs-4 control-label">Entity Name</label>
      <div class="col-xs-6">
        <input type="text" class="form-control input-sm" id="attrib_name" name="attrib_name">
      </div>
    </div>
  <% end %>

  <div id="options"></div>

  <div id="scan">
    <div class="form-group">
      <label for="attrib_name" class="col-xs-4 control-label">Recursive Depth</label>
      <div class="col-xs-6">
        <select class="form-control input-sm" name="depth" id="depth">
          <option value=1 selected="true">Interactive</option>
          <option value=2>1 Iteration</option>
          <option value=3>2 Iterations</option>
          <option value=4>3 Iterations</option>
          <option value=5>4 Iterations</option>
        </select>
      </div>
    </div>
  </div>
  <hr></hr>

  <input class="btn btn-primary" type="submit" value="Run Task">
</form>
</div>

<script src="/js/task.js"></script>
