module Intrigue
  module Issue
  class VulnerabilityBluekeep < BaseIssue
  
    def self.generate(instance_details={})
      {
        added: "2020-01-01",
        name: "vulnerability_bluekeep",
        pretty_name: "Microsoft Remote Desktop - Bluekeep (CVE-2019-0708)",
        identifiers: [
          { type: "CVE", name: "CVE-2019-0708" }
        ],
        severity: 1,
        status: "confirmed",
        category: "vulnerability",
        description: "A remote code execution vulnerability exists in Remote Desktop Services – formerly known as Terminal Services – when an unauthenticated attacker connects to the target system using RDP and sends specially crafted requests. This vulnerability is pre-authentication and requires no user interaction. An attacker who successfully exploited this vulnerability could execute arbitrary code on the target system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights.",
        remediation: "Apply the relevant patch for your operating system, or disable RDP if not needed.",
        affected_software: [
          { :vendor => "Microsoft", :product => "Windows", :port => 3389 },
        ],
        references: [
          { type: "description", uri: "https://blogs.technet.microsoft.com/msrc/2019/05/14/prevent-a-worm-by-updating-remote-desktop-services-cve-2019-0708/" } , 
          { type: "description", uri: "https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-0708" } , 
        ],
        check: "vuln/microsoft_smb_bluekeep_check"
      }.merge!(instance_details)
    end
  
  end
  end
  end
  
  
          
  