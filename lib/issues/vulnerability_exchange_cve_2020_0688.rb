module Intrigue
  module Issue
  class VulnExchangeCve20200688 < BaseIssue
  
    def self.generate(instance_details={})
      {
        added: "2020-03-15",
        name: "vulnerability_exchange_cve_2020_0688",
        pretty_name: "Microsoft Exchange ECP Static Key Vulnerability (CVE-2020-0688)",
        identifiers: [
          { type: "CVE", name: "CVE-2020-0688" }
        ],
        severity: 1,
        status: "confirmed",
        category: "vulnerability",
        description: "CVE-2020-0688 is a static key vulnerability in Microsoft Exchange Control Panel (ECP), a component of Microsoft Exchange Server. The use of static keys could allow an authenticated attacker with any privilege level to send a specially crafted request to a vulnerable ECP and gain SYSTEM level arbitrary code execution.",
        remediation: "",
        affected_software: [
          { :vendor => "Microsoft", :product => "Exchange Server", :version => "2007" },
          { :vendor => "Microsoft", :product => "Exchange Server", :version => "2010", :update => "Service Pack 3"  },
          { :vendor => "Microsoft", :product => "Exchange Server", :version => "2013", :update => "Cumulative Update 23" },
          { :vendor => "Microsoft", :product => "Exchange Server", :version => "2016", :update => "Cumulative Update 14" },
          { :vendor => "Microsoft", :product => "Exchange Server", :version => "2016", :update => "Cumulative Update 15" },
          { :vendor => "Microsoft", :product => "Exchange Server", :version => "2019", :update => "Cumulative Update 3" },
          { :vendor => "Microsoft", :product => "Exchange Server", :version => "2019", :update => "Cumulative Update 4" }
        ],
        references: [
          { type: "description", uri: "https://nvd.nist.gov/vuln/detail/CVE-2020-0688"},
          { type: "description", uri: "https://www.tenable.com/blog/cve-2020-0688-microsoft-exchange-server-static-key-flaw-could-lead-to-remote-code-execution"},
          { type: "threat_intel", uri: "https://www.volexity.com/blog/2020/03/06/microsoft-exchange-control-panel-ecp-vulnerability-cve-2020-0688-exploited/"},
          { type: "threat_intel", uri: "https://www.us-cert.gov/ncas/current-activity/2020/03/10/unpatched-microsoft-exchange-servers-vulnerable-cve-2020-0688"}
        ],
        check: "vuln/microsoft_exchange_cve_2020_0688"
      }.merge!(instance_details)
    end
  
  end
  end
  end
  
  
          
  